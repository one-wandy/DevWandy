{% include "base/base.html" %}
{% block content %}
{% load static %}
<div class="p-3 d-flex  ">
      <div class="w-50 d-flex flex-wrap align-content-center  flex-wrap">
            <h3 class="p-0 m-0">
                  Clientes
            </h3>
            <p class="text-black-50 w-100">
                  Permite encontrar f√°cilmente los datos de contacto de cualquier cliente.
            </p>
      </div>
      <div class="d-flex justify-content-end w-50">
            <img src="{% static "icons/fycas.jpg" %}" weight="300" alt="" srcset="">
      </div>
</div>

<section class="section p-2 m-2 ">
      <div class="d-flex p-2 flex-wrap justify-content-end" >
            <div class="">
            </div>
            <input type="text"  style="min-height: 3rem; max-height: 3rem; width: 10rem;" class="form-control  p-3  m-0 mb-3"  id="searching-config" placeholder=" Buscar...">
          <div class="d-flex w-100 justify-content-end">
            <a href="{% url "customer:add-customer" %}">
                  <button class="border-0  bg-white">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person-plus-fill" viewBox="0 0 16 16">
                              <path d="M1 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6"/>
                              <path fill-rule="evenodd" d="M13.5 5a.5.5 0 0 1 .5.5V7h1.5a.5.5 0 0 1 0 1H14v1.5a.5.5 0 0 1-1 0V8h-1.5a.5.5 0 0 1 0-1H13V5.5a.5.5 0 0 1 .5-.5"/>
                            </svg> Cliente
                  </button>
            </a>
          </div>
      </div>
      <div id="config-list">
      </div>
      <ul id="list-customer" class="list-group list-group-flush">
            {% for c in customer %}
            
                  <li class="list-group-item bg-white bg-opacity-75  mb-1 p-4" style=" border-radius:1.5rem;">
                        <div class="d-flex  p-2" style="font-size: 15px !important;">
                              <div class="d-flex flex-wrap w-50">
                                    <img src="{{c.img1}}" style="width: 230px; height: 150px; border-radius: 12px; margin-right: 0.3rem;" alt="Imagen ccon Problemas" class="img object-fit-cover">
                                    <img src="{{c.img2}}" style="width: 230px; height: 150px; border-radius: 12px; margin-right: 0.3rem;" alt="Imagen con" class="img object-fit-cover">
                                    <div class="d-flex align-content-center flex-wrap">
                                          <span class="w-100"  style="font-size: 16px; " >
                                               <strong>Nombre y Apellidos:</strong> 
                                               <span style=""> {{c.name}} {{c.last_name}}
                                                </span> 
                                         </span> 
                                         <span class="w-100">
                                                <strong>No. Cedula:</strong> {{c.dni}} 
                                         </span>
                                         <span class="w-100">
                                          <strong>Recide en <span class="text-black-50">(BETTA)</span>:</strong> <a style="text-transform: capitalize;" href="https://www.google.com.do/maps/search/{{c.address}}">
                                                 <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-geo-alt-fill" viewBox="0 0 16 16">
                                                <path d="M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10m0-7a3 3 0 1 1 0-6 3 3 0 0 1 0 6"/>
                                              </svg> {{c.address}}</a>
                                          </span>
                                          <span class="w-100">
                                                <strong>Informacion Laborar:</strong> {{c.work_information}}
                                         </span>
                                          <span class="w-100">
                                                <strong>
                                                      Referencias:
                                                </strong>
                                                {{c.name_r1}} ({{c.number_r1}}) - {{c.name_r2}} ({{c.number_r2}})
                                          </span>
                                    </div>
                              </div>
                              <div class="d-flex justify-content-end align-content-center flex-wrap w-50">
                                    <div style="width: 25rem;">
                                          <a href="{% url "customer:detail-customer" c.id %}">
                                                <button class='border-0'>
                                                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person-fill" viewBox="0 0 16 16">
                                                            <path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6"/>
                                                          </svg>
                                                          Perfil de Usuario
                                                </button>
                                          </a>
                                          <a href="{% url "customer:update-customer" c.id %}">
                                                <button class='border-0'>
                                                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-brush-fill" viewBox="0 0 16 16">
                                                            <path d="M15.825.12a.5.5 0 0 1 .132.584c-1.53 3.43-4.743 8.17-7.095 10.64a6.1 6.1 0 0 1-2.373 1.534c-.018.227-.06.538-.16.868-.201.659-.667 1.479-1.708 1.74a8.1 8.1 0 0 1-3.078.132 4 4 0 0 1-.562-.135 1.4 1.4 0 0 1-.466-.247.7.7 0 0 1-.204-.288.62.62 0 0 1 .004-.443c.095-.245.316-.38.461-.452.394-.197.625-.453.867-.826.095-.144.184-.297.287-.472l.117-.198c.151-.255.326-.54.546-.848.528-.739 1.201-.925 1.746-.896q.19.012.348.048c.062-.172.142-.38.238-.608.261-.619.658-1.419 1.187-2.069 2.176-2.67 6.18-6.206 9.117-8.104a.5.5 0 0 1 .596.04"/>
                                                          </svg> Editar
                                                </button>
                                          </a>

                                    <a href="">
                                          {% if c.credit  %}
                                                <a href="{% url "customer:list-credit" c.id %}">
                                                      <button class='border-0'>
                                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-cash-stack" viewBox="0 0 16 16">
                                                                  <path d="M1 3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1zm7 8a2 2 0 1 0 0-4 2 2 0 0 0 0 4"/>
                                                                  <path d="M0 5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1zm3 0a2 2 0 0 1-2 2v4a2 2 0 0 1 2 2h10a2 2 0 0 1 2-2V7a2 2 0 0 1-2-2z"/>
                                                                </svg>
                                                            Creditos  
                                                      </button>
                                                </a>
                                                {% else %}
                                                <a href="{% url "customer:create-credit" c.id %}">
                                                      <button class=' border-0'>
                                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-plus-circle-fill" viewBox="0 0 16 16">
                                                            <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M8.5 4.5a.5.5 0 0 0-1 0v3h-3a.5.5 0 0 0 0 1h3v3a.5.5 0 0 0 1 0v-3h3a.5.5 0 0 0 0-1h-3z"/>
                                                            </svg>
                                                            Crear Credito
                                                      </button>
                                                </a>
                                              
                                          {% endif %}
                                    </a>
                                    </div>
                              </div>
                       </div>
                        <div class="d-flex justify-content-end">

                        </div>
                  </li>
            {% endfor %}
          </ul>
</section>
<script>
      let searching_config = document.getElementById('searching-config');
    let config_list = document.getElementById('config-list')
    let config_data;

    searching_config.focus();
    window.addEventListener("DOMContentLoaded", function() {
        ConfigData()
        function ConfigData() {
            const url = 'searching/customer';
            $.ajax({
                url: url,
                success: function(data){
                    config_data = data
                    const searching_config = document.getElementById('searching-config');
                    searching_config.addEventListener('input', (event) => {
                    const input_value = event.target.value;
                    const filtered_data = data.filter((config) => {
                        return config.name.toLowerCase().includes(input_value.toLowerCase());
                    });
                    config_list.innerHTML = ''
                    for (const c  of filtered_data) {
                        const div = document.createElement('div');
                        div.classList.add("divCon", "p-4", "m-1")
                              let divI = document.createElement("div")
                              let img = document.createElement("img")
                                    img.classList.add("img")
                                    img.src = c.img
                                    divI.appendChild(img)
                              let divL = document.createElement("div")
                              let stronL = document.createElement("strong")
                                    stronL.textContent = "Nombre y Apellido: "
                              let spanL = document.createElement("span")
                              spanL.classList.add("capitalize")
                                    spanL.textContent = c.name
                              divL.appendChild(stronL)
                              divL.appendChild(spanL)

                              let divN = document.createElement("div")
                                    let stronN = document.createElement("strong")
                                          stronN.textContent = "No. Cedula: "
                                    let spanN = document.createElement("span")
                                          spanN.textContent = c.dni
                              divN.appendChild(stronN)
                              divN.appendChild(spanN)

                              let divA = document.createElement("div")
                                    let stronA = document.createElement("strong")
                                          stronA.textContent = "Informacion Laboral: "
                                    let spanA = document.createElement("span")
                                          spanA.textContent = c.inf
                              divA.appendChild(stronA)
                              divA.appendChild(spanA)

                              let divR = document.createElement("div")
                                    let stronR = document.createElement("strong")
                                          stronR.textContent = "Recide en: "
                                    let spanR = document.createElement("a")
                                          spanR.href = c.recide
                                          spanR.textContent = c.recide
                              divR.appendChild(stronR)
                              divR.appendChild(spanR)

                              
                              let divK = document.createElement("div")
                                    let stronK = document.createElement("strong")
                                          stronK.textContent = "Referencias: "
                                    let spanK = document.createElement("span")
                                          spanK.textContent = c.refers
                              divK.appendChild(stronK)
                              divK.appendChild(spanK)


                        div.appendChild(divI);
                        div.appendChild(divL);
                        div.appendChild(divN);
                        div.appendChild(divR);
                        div.appendChild(divA);
                        div.appendChild(divK);



                        config_list.appendChild(div);
                    }
                    if (searching_config.value.trim() === "") {
                        config_list.innerHTML = ''
                        config_list.style.display = 'none'
                        document.getElementById("list-customer").style.display = "block"
                        
                    }
                    else {
                        config_list.style.display = 'block'
                        document.getElementById("list-customer").style.display = "none"
                        
                    }
                    });
                },
                error: function(xhr, status, error) {
                    console.error('Error en la solicitud AJAX:', status, error);
                }
            });
        }
    });
</script>
</script>
{% endblock  %}